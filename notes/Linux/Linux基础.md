# Linux基础知识

- [1. 帮助](#1-帮助)
    - [1.1 --help](#11---help)
    - [1.2 man](#12-man)
    - [1.3 doc](#13-doc)
- [2. vim](#2-vim)
- [3. 目录结构](#3-目录结构)
- [4. 网络](#4-网络)
    - [4.1 DNS配置](#41-dns配置)
    - [4.2 网络配置](#42-网络配置)
- [5. sudo命令](#5-sudo命令)
- [6. inode](#6-inode)
    - [6.1 使用inode号删除一个文件](#61-使用inode号删除一个文件)
- [7. 文件处理命令](#7-文件处理命令)
    - [7.1 mkdir](#71-mkdir)
    - [7.2 cd](#72-cd)
    - [7.3 pwd](#73-pwd)
    - [7.4 rmdir](#74-rmdir)
    - [7.5 rm](#75-rm)
    - [7.6 cp](#76-cp)
    - [7.7 mv](#77-mv)
    - [7.8 ln](#78-ln)
        - [7.8.1 硬链接特征](#781-硬链接特征)
        - [7.8.2 软链接特征](#782-软链接特征)
- [8. 文件搜索命令](#8-文件搜索命令)
    - [8.1 whereis](#81-whereis)
    - [8.2 which](#82-which)
    - [8.3 环境变量](#83-环境变量)
    - [8.4 find](#84-find)
        - [8.4.1 按名称搜索(-name)](#841-按名称搜索-name)
        - [8.4.2 通配符](#842-通配符)
        - [8.4.3 不区分大小写(-i)](#843-不区分大小写-i)
        - [8.4.4 按所有者搜索(-user)](#844-按所有者搜索-user)
        - [8.4.5 按时间搜索](#845-按时间搜索)
        - [8.4.6 按文件大小搜索(-size)](#846-按文件大小搜索-size)
        - [8.4.7 按i节点搜索(-inum)](#847-按i节点搜索-inum)
        - [8.4.8 综合应用](#848-综合应用)
    - [8.5 grep](#85-grep)
- [8. 帮助命令](#8-帮助命令)
    - [8.1 基本用法](#81-基本用法)
    - [8.2 关键字搜索](#82-关键字搜索)
    - [8.3 shell内部帮助](#83-shell内部帮助)
- [9. 压缩和解压命令](#9-压缩和解压命令)
    - [9.1 zip格式](#91-zip格式)
    - [9.2 gzip格式](#92-gzip格式)
    - [9.3 bz2格式](#93-bz2格式)
    - [9.4 tar](#94-tar)
        - [9.4.1 打包命令](#941-打包命令)
        - [9.4.2 压缩命令](#942-压缩命令)
- [10. 关机重启命令](#10-关机重启命令)
    - [10.1 shutdown](#101-shutdown)
    - [10.2 init](#102-init)
- [11. 查看用户系统](#11-查看用户系统)
    - [11.1 w](#111-w)
    - [11.2 who](#112-who)
    - [11.3 last](#113-last)
    - [11.4 lastlog](#114-lastlog)
- [12. 命令的生效顺序](#12-命令的生效顺序)

----------

## 1. 帮助

### 1.1 --help

一般指令的基本用法与选项介绍

### 1.2 man

使用man手册进行查找。对于man手册的使用采用**`man man`**即可

[man手册介绍](https://github.com/YKitty/Notes/blob/master/notes/Linux/bash%E8%AF%A6%E8%A7%A3.md#3-man%E8%AF%A6%E8%A7%A3 )

### 1.3 doc

/usr/share/doc下存放软件的一整套说明文件



## 2. vim

Linux下没有Windows下的IDE（集成开发环境），Linux执行一个程序预处理，编译，汇编，链接这四部分是分开的，有不同的程序完成

Linux下编写代码就只有一个**文本编辑器vim**

对于vim学习与配置：

1. 终端使用**vimtutor命令**
2. [学习](https://vim.ink/)



## 3. 目录结构

- bin：常用的命令
- boot：启动Linux系统过程中需要用到的文件
- dev：Linux系统中使用到的外部设备文件（Linux下一切皆文件）
- etc：各种配置文件和子目录
- sbin：系统管理员的系统管理程序
- home：存放普通用户的主目录
- lib：存放系统动态链接库
- mnt：用户可将别的文件系统挂载，比如另外的硬盘
- proc：虚拟目录，系统内存的映射，获取Linux系统信息
- root：超级用户的主目录
- usr：用户的应用程序和文件，类似于Windows下的program files
  - bin：存放系统用户使用的应用程序
  - sbin：存放超级用户所使用的高级程序以及系统守护程序
  - src：内核源代码默认放置目录
- tmp：存放临时文件
- run：系统运行需要的文件
- var：经常被修改的文件，比如日志文件，电子邮件等



## 4. 网络

### 4.1 DNS配置

**`vim /etc/resolv.conf`**

模板配置：

``` C++
# Generated by NetworkManager
search DHCP HOST                                               
nameserver 202.200.48.6
nameserver 218.30.19.50
nameserver 8.8.8.8
```

**resolv.conf是resolver类库使用的配置文件，每当一个程序需要通过域名来访问internet上面的其它主机时，需要利用该类库将域名转换成对应的IP，然后才可进行访问.**

resolv.conf文件的配置选项不多，从man文档中看了半天，不理解domain和search使用来干嘛的。这里做个解释，防止以后忘了（环境：ubuntu12.04）：

**nameserver** x.x.x.x该选项用来制定DNS服务器的，可以配置多个nameserver指定多个DNS。

**domain** mydomain.com这个用来指定本地的域名，在没有设置search的情况下，search默认为domain的值。这个值可以随便配，目前在我看来，domain除了当search的默认值外，没有其它用途。也就说一旦配置search，那domain就没用了。

**search** google.com baidu.com该选项可以用来指定多个域名，中间用空格或tab键隔开。它是干嘛的呢？

如：在没有配置该选项时，执行

``` C++
ping  new
sping: unknown host news
```

配置search google.com baidu.com后，再执行

``` C++
#ping news
PING news.google.com (74.125.128.101) 56(84) bytes of data.
64 bytes from hg-in-f101.1e100.net (74.125.128.101): icmp_req=1 ttl=47time=78.9 ms
64 bytes from hg-in-f101.1e100.net (74.125.128.101): icmp_req=2 ttl=47time=63.6 ms
```

它就去ping news.google.com了。原来当访问的域名不能被DNS解析时，resolver会将该域名加上search指定的参数，重新请求DNS，直到被正确解析或试完search指定的列表为止。

由于news不能被DNS解析，所以去尝试news.google.com，被正常解析。如果没有被解析还会去尝试news.baidu.com。

### 4.2 网络配置

**`vim /etc/sysconfig/network-scripts/ifcfg-ens33 `**

模板配置：

``` C++
TYPE=Ethernet                                                 PROXY_METHOD=none    
BROWSER_ONLY=no    
BOOTPROTO=dhcp    
DEFROUTE=yes             
IPV4_FAILURE_FATAL=no    
IPV6INIT=yes         
IPV6_AUTOCONF=yes    
IPV6_DEFROUTE=yes        
IPV6_FAILURE_FATAL=no                
IPV6_ADDR_GEN_MODE=stable-privacy    
NAME=ens33    
UUID=b9d080ce-f726-41fa-9a27-ef64a6aff8d7    
DEVICE=ens33    
ONBOOT=yes    

PEERDNS=no
DNS1=202.200.48.6
DNS2=218.30.19.50
DNS3=8.8.8.8
```

**`PEERDNS=no`**是为了在进行**`service network restart`**之后不会将DNS的配置又变回以前的配置，而自己配置的没有起作用，可以自己设置一些DNS服务器，比如国内比较好用的**114.114.114.114和国外的8.8.8.8**

第二种方法：

修改 **`/etc/NetworkManager/NetworkManager.conf`** 文件，在main部分添加 “dns=none” 选项：(不操作这一步，直接修改/etc/resolv.conf，重启网卡又会变回改之前的配置） 

## 5. sudo命令

1. 切换到root用户下。su
2. 为/etc/sudoers添加执行权限。chmod +x /etc/sudoers
3. 在/etc/soduers中的root （ALL）=（ALL）ALL下面添加。使用gedit编辑器
   1. 用户名 （ALL）= （ALL）ALL即可退出保存



## 6. inode

### 6.1 使用inode号删除一个文件

直接删除：**`find ./* -inum 192712179 -delete`**

询问之后删除：**`find ./* -inum 1049741 -exec rm -i {} \; `**



## 7. 文件处理命令

### 7.1 mkdir

- **创建目录（make directory）**
- mkdir -p [目录名]
  - -p 递归创建

### 7.2 cd

- **切换所在目录（change directory）**
- cd [目录]
  - ~  家目录
  - 家目录 （直接使用目录）
  - -（上次的目录）
  - . 当前目录
  - .. 上级目录

### 7.3 pwd

- **显示当前目录**

### 7.4 rmdir

- **删除目录 （remove empty directory）**
- rmdir [目录名]

### 7.5 rm

- **删除文件或者目录（remove）**
- rm [文件或者目录]
  - -r 删除目录（递归）
  - -f 强制删除
- rm -rf [文件或者目录] 递归强制删除所有目录

### 7.6 cp

- **赋值命令 （copy）**
- cp [源文件]\[目标文件] 
  - -r 复制目录（递归复制），默认是赋值文件
  - -p 连带文件属性复制
  - -d 若源文件是链接文件，则赋值链接属性
  - -a 相当于-rpd

### 7.7 mv

- **移动文件或者改名（move）**
- mv [源文件或者目录]\[目标文件或者新文件名]

### 7.8 ln

- **链接命令，生成链接文件（link）**

#### 7.8.1 硬链接特征

- ln [源文件]\[目标文件]

- 拥有相同的i节点和存储block块，可以看做是同一个文件
- 可以通过i节点访问
- 不能跨分区（不能适用于多个文件系统）
- 不能针对目录使用
- 一般不使用

#### 7.8.2 软链接特征

- ln -s [源文件]\[目标文件]
  - -s 创建软链接
- 类似于windows下的快捷方式
- 软链接拥有自己的i节点和block块，但是数据块中存放的是源文件的文件名和i节点号，并没有实际的文件数据
- lrwxrwxrwx 软链接的文件权限都是777
- 修改任意一个文件，另一个都会改变
- 删除源文件，软链接不能使用
- 软链接源文件必须写绝对路径



## 8. 文件搜索命令

### 8.1 whereis

- 搜索命令所在路径以及帮助文档所在位置
- whereis 命令名 （whereis ls）
  - -b 只查找可执行文件
  - -m 只查找帮助文档

### 8.2 which

- 可以看到别名**which ls**
- 能看到的都是外部安装的命令，无法查看Shell自带的命令，如which cd

### 8.3 环境变量

- 定义的是系统搜索命令的路径
- echo $PATH

### 8.4 find

- 文件搜索命令
- find [搜索范围]\[搜索条件]

#### 8.4.1 按名称搜索(-name)

- 避免大范围的搜索，会非常消耗系统资源
- **find / -name aaa.log**

#### 8.4.2 通配符

- find是在系统当中搜索符合条件的文件名，如果需要匹配，使用通配符皮匹配，通配符是完全匹配
- 通配符
  - *****匹配任意内容
  - **？**匹配任意一个字符
  - **[]**匹配任意一个中括号内的字符

#### 8.4.3 不区分大小写(-i)

- 不区分大小写
- **find / -iname A.log**

#### 8.4.4 按所有者搜索(-user)

- **find / -iuser root**

#### 8.4.5 按时间搜索

- find / -mtime +5

| 参数  |       含义       |
| :---: | :--------------: |
| atime |   文件访问时间   |
| mtime | 文件内容修改时间 |
| ctime | 文件属性修改时间 |

| 参数 |       含义        |
| :--: | :---------------: |
|  -5  |  5天之内修改文件  |
|  5   | 5天前当天修改文件 |
|  +5  | 5天前之前修改文件 |

#### 8.4.6 按文件大小搜索(-size)

- **k小写，M大写**
- **find / -size 100k**

| 参数 |  含义  |
| :--: | :----: |
| -8k  | 小于8k |
|  8k  | 等于8k |
| +8k  | 大于8k |
| +8M  | 大于8M |

#### 8.4.7 按i节点搜索(-inum) 

- **find / -inum 123456**

#### 8.4.8 综合应用

- **find /tmp -size +10k -a -size -20k**
- 查找/tmp目录下，大于10KB并且小于20KB的文件
- -a and 逻辑与，两个条件都满足
- -o 逻辑或，两个条件只需要满足一个
- **find /tmp -size +10k -a -size -20k -exec ls -1h {} \;**
- **exec对上个命令的结果进行操作**

### 8.5 grep

- 在文件中匹配符合条件的字符串
- **grep “10” access.log**
  - -i 忽略大小写
  - -v 排除指定字符串
- find命令，在系统中搜索符合条件的文件名，如果需要匹配，使用通配符匹配，通配符是完全匹配
- grep命令在文件当中搜索符合条件的字符串，如果需要匹配使用正则表达式进行匹配，正则表达时包含匹配



## 8. 帮助命令

### 8.1 基本用法

- man命令 获取指定命令的帮助
- tldr命令 获取对于一个命令简化的解释

### 8.2 关键字搜索

- **man -k passwd**

### 8.3 shell内部帮助

- whereis找到就是外部，找不到就是内部
- **help cd**

## 9. 压缩和解压命令

**.zip .gz .bz2 .tar.gz .tar.bz2**

### 9.1 zip格式

- 压缩文件：zip 压缩文件名 源文件

- 压缩目录：zip -r 压缩文件名 源目录

- 解压：unzip 压缩文件名

- ``` C++
  mkdir test
  touch 1.c
  touch 2.c
  zip -r test.zip test
  unzip test.zip
  ```

### 9.2 gzip格式

|           命令           |            示例            |                  含义                   |
| :----------------------: | :------------------------: | :-------------------------------------: |
|       gzip 源文件        |         gzip a.txt         |  压缩为.gz格式的压缩文件，源文件会消失  |
| gzip -c 源文件> 压缩文件 | gzip -c yum.txt>yum.txt.gz | 压缩为.gz格式的压缩文件，源文件不会消失 |
|       gzip -r 目录       |        gzip -r test        |  压缩目录下的所有文件，但是不压缩目录   |
|    gzip -d 压缩文件名    |     gzip -d yum.txt.gz     |        解压缩文件，不保留压缩包         |
|     gunzip 压缩文件      |     gunzip yum.txt.gz      |        解压缩文件，不保留压缩包         |

### 9.3 bz2格式

|        命令         |        示例        |                含义                |
| :-----------------: | :----------------: | :--------------------------------: |
|    bzip2 源文件     |    bzip2 1.txt     | 压缩为.bz2格式的文件，不保留源文件 |
|   bzip2 -k 源文件   |   zip2 -k 1.txt    |  压缩为.bz2格式的文件，保留源文件  |
| bzip2 -d 压缩文件名 | bzip2 -d 1.txt.bz2 |             解压压缩包             |
| bunzip2 压缩文件名  | bunzip2 1.txt.bz2  |             解压压缩包             |

- **bzip不能压缩目录**

### 9.4 tar

#### 9.4.1 打包命令

- tar -cvf 打包文件名 源文件

  - -c 打包
  - -v 显示过程
  - -f 指定打包后的文件名

- ``` C++
  //进行打包
  tar -cvf book.tar book
  //采用gzip方式压缩
  gzip book.tar
  //采用bz2方式压缩
  bzip2 book.tar
  ```

- **-x解打包**

- ``` c++
  tar -xvf book.tar
  ```

#### 9.4.2 压缩命令

- **压缩**

``` C++
//将目录里所有jpg文件打包成jpg.tar
tar -cvf jpg.tar *.jpg
//将目录下所有jpg文件打包成jpg.tar之后，并将其使用gzip格式进行压缩，生成一个gzip压缩包，命名为jpg.tar.gz
tar -czf jpg.tar.gz *.jpg
//将目录下所有jpg文件打包成jpg.tar之后，并将其使用bzip2压缩，生成一个bzip2压缩过的包，命名为jpg.tar.bz2
tar -cjf jpg.tar.bz2 *.jpg
//将目录下所有的jpg文件打包成jpg.tar之后，并将其使用compress压缩，生成一个uncompress压缩过的包，命名为jpg.tar.Z
tar -cZf jpg.tar.Z *.jpg
//rar格式的压缩，需要先下载rar for Linux
rar	a jpg.rar *.jpg
//zip格式的压缩，需要先下载zip for Linux
zip jpg.zip *.jpg
```

- **解压**

``` C++
//解压tar包
tar -xvf file.tar
//解压tar.gz
tar -xzvf file.tar.gz
//解压tar.bz2
tar -xjvf file.tar.bz2
//解压tar.Z
tar -xZvf file.tar.Z
//解压rar
unrar e file.tar
//解压zip
unzip file.zip
```

## 10. 关机重启命令

###  10.1 shutdown

**shutdown关机命令**

- -c 取消前一个关机命令
- -h 关机
- -r 重启

### 10.2 init

**关机**

- ``` 
  init 0
  ```

**重启**

- ``` 
  init 6
  ```

系统的运行级别

- 0 关机

- 1 单用户

- 2 不完全多用户，不包含NFS服务

- 3 完全多用户

- 4 未分配

- 5 图形界面

- 6 重启

 ### 10.3 logout

**退出登录**

``` 
logout
```

## 11. 查看用户系统

### 11.1 w

**查看登录用户信息**

- USER 登录的用户名
- TTY 登录的终端
  - tty1 本地终端
  - pts/0 远程终端
- FROM 登录IP
- LOGIN 登录时间（登录IP）
- IDLE 用户闲置时间
- JCPU 该终端所有进程占用时间
- PCPU 当前进程所占用时间
- WHAT 正在执行的命令

### 11.2 who

**查看登录用户信息**

- USER 登录的用户名
- TTY 登录的终端
  - tty1 本地终端
  - pts/0 远程终端
- LOGIN 登录时间（登录IP）

### 11.3 last

查看当前登录和过去登录的用户信息，默认读取`/var/log/wtmp`文件

### 11.4 lastlog

**查看所有用户的最后一次登录时间**

## 12. 命令的生效顺序

1. 绝对路径或者相对路径
2. 别名
3. bash内部命令
4. 按照$PATH环境变脸定义的目录查找顺序找到的第一个命令





  